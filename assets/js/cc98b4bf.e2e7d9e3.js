"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5275],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>u});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=n.createContext({}),l=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},c=function(e){var t=l(e.components);return n.createElement(o.Provider,{value:t},e.children)},h="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),h=l(a),m=r,u=h["".concat(o,".").concat(m)]||h[m]||d[m]||i;return a?n.createElement(u,s(s({ref:t},c),{},{components:a})):n.createElement(u,s({ref:t},c))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,s=new Array(i);s[0]=m;var p={};for(var o in t)hasOwnProperty.call(t,o)&&(p[o]=t[o]);p.originalType=e,p[h]="string"==typeof e?e:r,s[1]=p;for(var l=2;l<i;l++)s[l]=a[l];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},2850:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>p,toc:()=>l});var n=a(7462),r=(a(7294),a(3905));const i={title:"Design"},s="Design GraphQL APIs",p={unversionedId:"reference/api/graphql/design",id:"reference/api/graphql/design",title:"Design",description:"The easiest way to design your custom GraphQL data API with DataSQRL is to start with the GraphQL schema that is generated by the compiler.",source:"@site/docs/reference/api/graphql/design.md",sourceDirName:"reference/api/graphql",slug:"/reference/api/graphql/design",permalink:"/docs/reference/api/graphql/design",draft:!1,editUrl:"https://github.com/DataSQRL/datasqrl.github.io/edit/main/docs/docs/reference/api/graphql/design.md",tags:[],version:"current",frontMatter:{title:"Design"},sidebar:"docs",previous:{title:"Data API",permalink:"/docs/reference/api/overview"},next:{title:"Query",permalink:"/docs/reference/api/graphql/query"}},o={},l=[{value:"Script to GraphQL Schema Mapping",id:"script-to-graphql-schema-mapping",level:2},{value:"Example GraphQL Schema",id:"example-graphql-schema",level:2}],c={toc:l},h="wrapper";function d(e){let{components:t,...a}=e;return(0,r.kt)(h,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"design-graphql-apis"},"Design GraphQL APIs"),(0,r.kt)("p",null,"The easiest way to design your custom GraphQL data API with DataSQRL is to start with the GraphQL schema that is generated by the compiler."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -v $PWD:/build datasqrl/datasqrl-cmd compile myscript.sqrl -a graphql\n")),(0,r.kt)("p",null,"When you add the ",(0,r.kt)("inlineCode",{parentName:"p"},"-a graphql")," option, the compiler writes a ",(0,r.kt)("inlineCode",{parentName:"p"},"schema.graphqls")," GraphQL schema file to the local directory where the compiler was invoked."),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("p",{parentName:"admonition"},"When you run the compiler with the ",(0,r.kt)("inlineCode",{parentName:"p"},"-a")," option it will overwrite an existing schema file of the same filename.")),(0,r.kt)("p",null,"The compiler generates ",(0,r.kt)("em",{parentName:"p"},"complete")," GraphQL schemas, which means that the schema contains all tables, fields, and relationships defined in the SQRL script as well as field filters for all fields. You can create your own custom GraphQL schema by trimming the generated schema and only expose those tables, fields, relationships, and filters that are required by your data API."),(0,r.kt)("h2",{id:"script-to-graphql-schema-mapping"},"Script to GraphQL Schema Mapping"),(0,r.kt)("p",null,"DataSQRL maps the tables, fields, and relationships defined in the SQRL script to a GraphQL schema which exposes the data through a GraphQL API."),(0,r.kt)("p",null,"Tables are mapped to types in the GraphQL schema and table columns map to fields of that type. The field data type is the same as the column data type from the table. If the type isn't available in GraphQL, it is serialized into a generic type like ",(0,r.kt)("inlineCode",{parentName:"p"},"string"),"."),(0,r.kt)("p",null,"Relationship columns of a table map to fields of the type associated with the table. The type of that field is the type associated with the table that the relationship links to."),(0,r.kt)("p",null,"The mapping between tables and types and (relationship) columns and fields is established by case-insensitive name. That means, to expose the table ",(0,r.kt)("inlineCode",{parentName:"p"},"Orders")," in the API we have to create a type ",(0,r.kt)("inlineCode",{parentName:"p"},"Orders")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"orders")," in the GraphQL schema."),(0,r.kt)("p",null,"Non-nested table in the script can also map onto query entry-points of the same name as the table which can be used to query the table."),(0,r.kt)("p",null,"Query fields and relationship fields accept arguments of the returned type which map onto equality predicate filters."),(0,r.kt)("h2",{id:"example-graphql-schema"},"Example GraphQL Schema"),(0,r.kt)("p",null,"The following is a GraphQL schema for the ",(0,r.kt)("a",{parentName:"p",href:"../../../getting-started/quickstart"},"Quickstart tutorial"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphqls"},"type Query {\n  Orders(time: String): [Orders!]\n  Users(id: Int!): Users\n}\n\ntype Users {\n  id: Int!\n  purchases: [Orders!]\n  spending(week: String): [spending!]\n}\n\ntype spending {\n  week: String!\n  spend: Float!\n  saved: Float!\n}\n\ntype Orders {\n  id: Int!\n  customerid: Int!\n  time: String!\n  items: [items!]\n  totals: totals\n}\n\ntype items {\n  productid: Int!\n  quantity: Int!\n  unit_price: Float!\n  discount: Float\n  total: Float!\n}\n\ntype totals {\n  price: Float!\n  saving: Float!\n}\n")))}d.isMDXComponent=!0}}]);