"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2356],{5680:(e,n,t)=>{t.d(n,{xA:()=>u,yg:()=>d});var r=t(6540);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=r.createContext({}),l=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=l(e.components);return r.createElement(s.Provider,{value:n},e.children)},p="mdxType",f={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),p=l(t),m=o,d=p["".concat(s,".").concat(m)]||p[m]||f[m]||a;return t?r.createElement(d,i(i({ref:n},u),{},{components:t})):r.createElement(d,i({ref:n},u))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=m;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c[p]="string"==typeof e?e:o,i[1]=c;for(var l=2;l<a;l++)i[l]=t[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},8750:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>f,frontMatter:()=>a,metadata:()=>c,toc:()=>l});var r=t(8168),o=(t(6540),t(5680));const a={},i="Implement Custom Functions",c={unversionedId:"reference/sqrl/functions/custom-functions",id:"reference/sqrl/functions/custom-functions",title:"Implement Custom Functions",description:"A custom function package contains function definitions and implementations that the DataSQRL compiler can import into a script.",source:"@site/docs/reference/sqrl/functions/custom-functions.md",sourceDirName:"reference/sqrl/functions",slug:"/reference/sqrl/functions/custom-functions",permalink:"/docs/reference/sqrl/functions/custom-functions",draft:!1,editUrl:"https://github.com/DataSQRL/datasqrl.github.io/edit/main/docs/reference/sqrl/functions/custom-functions.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Vector Functions",permalink:"/docs/reference/sqrl/functions/vector"},next:{title:"Deployment",permalink:"/docs/reference/sqrl/deployments"}},s={},l=[{value:"Functions in Java",id:"functions-in-java",level:2},{value:"Upload User-Defined Functions to the Repository",id:"upload-user-defined-functions-to-the-repository",level:2},{value:"Create <code>package.json</code>",id:"create-packagejson",level:3},{value:"Create Function Descriptors",id:"create-function-descriptors",level:3},{value:"Publish the Package",id:"publish-the-package",level:3},{value:"Test Your UDF",id:"test-your-udf",level:3}],u={toc:l},p="wrapper";function f(e){let{components:n,...t}=e;return(0,o.yg)(p,(0,r.A)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.yg)("h1",{id:"implement-custom-functions"},"Implement Custom Functions"),(0,o.yg)("p",null,"A custom function package contains function definitions and implementations that the DataSQRL compiler can import into a script."),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},"Before implementing a custom function package, check if the function you need is part of the ",(0,o.yg)("a",{parentName:"p",href:"/docs/category/sqrl-functions"},"system function library")," or can be found in the ",(0,o.yg)("a",{parentName:"p",href:"https://dev.datasqrl.com"},"repository"),".")),(0,o.yg)("p",null,"To create a new function package, first create a sub-folder ",(0,o.yg)("inlineCode",{parentName:"p"},"myFunctionPackage")," in the directory of the script where you want to import the functions. "),(0,o.yg)("p",null,"Then follow the instructions below for implementing a function package in the language of your choice."),(0,o.yg)("h2",{id:"functions-in-java"},"Functions in Java"),(0,o.yg)("p",null,"See the java user defined function example in our ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/DataSQRL/datasqrl-examples/tree/main/user-defined-function"},"examples"),"."),(0,o.yg)("h2",{id:"upload-user-defined-functions-to-the-repository"},"Upload User-Defined Functions to the Repository"),(0,o.yg)("p",null,"If you want to upload your custom UDF to the Datasqrl repository, you need to take some extra steps."),(0,o.yg)("p",null,"In the same folder where the JAR file resides (e.g., ",(0,o.yg)("inlineCode",{parentName:"p"},"myudf-0.1.0-SNAPSHOT.jar"),"), create the following files."),(0,o.yg)("h3",{id:"create-packagejson"},"Create ",(0,o.yg)("inlineCode",{parentName:"h3"},"package.json")),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"package.json")," file defines the package manifest, such as name, version, etc. A minimal ",(0,o.yg)("inlineCode",{parentName:"p"},"package.json")," looks like this:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre"},'{\n  "version": "1",\n  "package": {\n    "name": "datasqrl.examples.udf",\n    "version": "0.5.5",\n    "latest": true\n  }\n}\n')),(0,o.yg)("p",null,"For detailed instructions on configuring the package manifest, please refer to the ",(0,o.yg)("a",{parentName:"p",href:"http://www.datasqrl.com/docs/reference/sqrl/datasqrl-spec/#packagejson"},"documentation"),"."),(0,o.yg)("h3",{id:"create-function-descriptors"},"Create Function Descriptors"),(0,o.yg)("p",null,"For each UDF in the JAR, create a ",(0,o.yg)("inlineCode",{parentName:"p"},"<functionname>.function.json")," descriptor. For example:"),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"myscalarfunction.function.json"),":"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre"},'{"language":"java","functionClass":"com.myudf.MyScalarFunction","jarPath":"datasqrl/examples/udf/myudf-0.1.0-SNAPSHOT.jar"}\n')),(0,o.yg)("h3",{id:"publish-the-package"},"Publish the Package"),(0,o.yg)("p",null,"Once you are done, log in to your repository account with ",(0,o.yg)("inlineCode",{parentName:"p"},"sqrl login"),", and issue ",(0,o.yg)("inlineCode",{parentName:"p"},"sqrl publish")," from the folder where ",(0,o.yg)("inlineCode",{parentName:"p"},"package.json")," resides."),(0,o.yg)("h3",{id:"test-your-udf"},"Test Your UDF"),(0,o.yg)("p",null,"To test your UDF, change the import path in the example as follows:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre"},"IMPORT myudf.Entry;\nIMPORT datasqrl.examples.udf.MyScalarFunction;\n\nMyTable := SELECT val, MyScalarFunction(val, val) AS myFnc\n           FROM Entry;\n")))}f.isMDXComponent=!0}}]);