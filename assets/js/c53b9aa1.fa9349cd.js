"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9616],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),u=a,m=d["".concat(l,".").concat(u)]||d[u]||h[u]||i;return n?r.createElement(m,o(o({ref:t},c),{},{components:n})):r.createElement(m,o({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:a,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6877:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var r=n(7462),a=(n(7294),n(3905));const i={title:"Relationship"},o="Relationships in SQRL",s={unversionedId:"reference/sqrl/relationship",id:"reference/sqrl/relationship",title:"Relationship",description:"SQRL supports relationship columns which relate a row in one table to rows in another table.",source:"@site/docs/reference/sqrl/relationship.md",sourceDirName:"reference/sqrl",slug:"/reference/sqrl/relationship",permalink:"/docs/reference/sqrl/relationship",draft:!1,editUrl:"https://github.com/DataSQRL/datasqrl.github.io/edit/main/docs/reference/sqrl/relationship.md",tags:[],version:"current",frontMatter:{title:"Relationship"},sidebar:"docs",previous:{title:"Table",permalink:"/docs/reference/sqrl/table"},next:{title:"Stream Table",permalink:"/docs/reference/sqrl/stream"}},l={},p=[{value:"JOINs",id:"joins",level:2},{value:"API Access",id:"api-access",level:2}],c={toc:p},d="wrapper";function h(e){let{components:t,...n}=e;return(0,a.kt)(d,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"relationships-in-sqrl"},"Relationships in SQRL"),(0,a.kt)("p",null,"SQRL supports relationship columns which relate a row in one table to rows in another table."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"Users.purchases := JOIN Orders ON Orders.customerid = @.id;\n")),(0,a.kt)("p",null,"This statement defines a relationship column ",(0,a.kt)("inlineCode",{parentName:"p"},"purchases")," on the ",(0,a.kt)("inlineCode",{parentName:"p"},"Users")," table that relates each user record to rows in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Orders")," table where the ",(0,a.kt)("inlineCode",{parentName:"p"},"customerid")," is equal to the user ",(0,a.kt)("inlineCode",{parentName:"p"},"id"),". In other words, ",(0,a.kt)("inlineCode",{parentName:"p"},"purchases")," relates users to their orders."),(0,a.kt)("p",null,"A relationship is defined via a ",(0,a.kt)("inlineCode",{parentName:"p"},"JOIN")," expression in standard SQL syntax. Relationships are defined as ",(0,a.kt)("a",{parentName:"p",href:"../table#localized"},"localized queries")," which means the ",(0,a.kt)("inlineCode",{parentName:"p"},"JOIN")," expression on the right-hand side of the statement is interpreted for each row of the table on which the relationship is defined and the at-sign ",(0,a.kt)("inlineCode",{parentName:"p"},"@")," is used to refer to each row."),(0,a.kt)("p",null,"Relationship columns are a convenient way to make relationships in the data explicit, simplify joins, and allow consumers of the data API to navigate through the data."),(0,a.kt)("h2",{id:"joins"},"JOINs"),(0,a.kt)("p",null,"Relationships can be used in ",(0,a.kt)("inlineCode",{parentName:"p"},"FROM")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"JOIN")," clauses of queries which makes complex join-queries easier to read. "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"Users.spending := SELECT endOfWeek(p.time) AS week,\n         sum(t.price) AS spend, sum(t.saving) AS saved\n      FROM @.purchases p JOIN p.totals t\n      GROUP BY week ORDER BY week DESC;\n")),(0,a.kt)("p",null,"This statement defines a nested table ",(0,a.kt)("inlineCode",{parentName:"p"},"spending")," underneath ",(0,a.kt)("inlineCode",{parentName:"p"},"Users")," which aggregates over the nested order ",(0,a.kt)("inlineCode",{parentName:"p"},"totals")," for all purchases of each user. Relationships used in ",(0,a.kt)("inlineCode",{parentName:"p"},"FROM")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"JOIN")," are expanded to their original definition. That means, ",(0,a.kt)("inlineCode",{parentName:"p"},"FROM @.purchases")," gets expanded to ",(0,a.kt)("inlineCode",{parentName:"p"},"FROM @ JOIN Orders p ON p.customerid = @.id"),"."),(0,a.kt)("p",null,"Relationships are particularly useful in the context of nested tables because they make it easy to navigate between parent and child. In the ",(0,a.kt)("a",{parentName:"p",href:"../../../getting-started/intro/overview"},"DataSQRL tutorial")," we define the nested ",(0,a.kt)("inlineCode",{parentName:"p"},"Orders.totals")," table as an aggregation over all items."),(0,a.kt)("p",null,"When defining a nested table, each child row has a relationship column ",(0,a.kt)("inlineCode",{parentName:"p"},"parent")," to relates the child row to its parent row. Likewise, the parent table has a relationship column with the name of the nested table that provides access to all child rows of the parent."),(0,a.kt)("p",null,"Hence, we are able to use ",(0,a.kt)("inlineCode",{parentName:"p"},"JOIN p.totals")," to join the totals for each order by following the ",(0,a.kt)("inlineCode",{parentName:"p"},"totals")," relationship on the order row."),(0,a.kt)("h2",{id:"api-access"},"API Access"),(0,a.kt)("p",null,"The relationships defined in a SQRL script can be exposed in the resulting data API to give consumers of the API the ability to navigate through the data and retrieve related records. Relationships make it possible to represent complex data efficiently through the API."),(0,a.kt)("p",null,"To learn more about how to expose and navigate relationships in the data API, refer to the ",(0,a.kt)("a",{parentName:"p",href:"../../api/overview"},"API documentation"),"."))}h.isMDXComponent=!0}}]);